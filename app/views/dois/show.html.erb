<div class="wrapper">
  <%= render 'shared/header' %>
  <h1><%= @record.doi %></h1>
  <%= link_to 'Edit', edit_doi_path(id: @record.id), :class => 'pure-button' %>
  <table class="pure-table pure-table-bordered">
    <%#= @metadata %>
    <tr><td><strong>Pure ID</strong></td><td><%= @record.pure_id %></td></tr>
    <tr><td><strong>Pure UUID</strong></td><td><%= @record.pure_uuid %></td></tr>

    <!--<tr><td><strong>Title</strong></td><td><%= @record.title %></td></tr>-->
    <tr><td><strong>Title</strong></td><td><%= @metadata["titles"]["title"] %></td></tr>

    <tr><td><strong>Description</strong></td><td><%= @metadata["descriptions"]["description"] %></td></tr>

    <tr>
      <td><strong>Creators</strong></td>
      <td>
        <%#= @metadata['creators']['creator'] %>

        <% case @metadata['creators']['creator'] %>
        <% when Hash %>
                <%= @metadata['creators']['creator']['creatorName'] %>
        <%  when Array %>
            <% @metadata['creators']['creator'].length.times do |i| %>
                <%= @metadata['creators']['creator'][i]['creatorName'] %>.
            <% end %>
        <% end %>
      </td>
    </tr>

    <% if @metadata['sizes'] %>
    <tr><td><strong>Files</strong></td>
      <td>

              <% case @metadata['sizes']['size'] %>
                <% when Array %>
                    <ul>
                    <% @metadata['sizes']['size'].length.times do |i| %>
                          <% if !@metadata['sizes']['size'][i].include? 'pages' %>
                              <li>
                                <%= @metadata['sizes']['size'][i] %>
                                <% if @metadata['formats']['format'] %>
                                    , <%= @metadata['formats']['format'] %>
                                <% end %>
                                <% if @metadata['rightsList']['rights'] %>
                                    , <%= @metadata['rightsList']['rights'] %>
                                <% end %>
                              </li>
                          <% end %>
                    <% end %>
                    </ul>
                <% else %>
                    <% if !@metadata['sizes']['size'][i].include? 'pages' %>
                        <%= @metadata['sizes']['size'] %>,
                        <%= @metadata['formats']['format'] %>
                        <% if @metadata['rightsList'] %>
                            , <%= @metadata['rightsList']['rights'] %>
                        <% end %>
                    <% end %>
                <% end %>
      </td>
    </tr>
    <% end %>
    <% if @metadata['sizes']['size'].last.include? 'pages' %>
        <tr>
          <td><strong>Pages</strong></td>
          <td>
            <%= @metadata['sizes']['size'].last.tr('pages','')  %>
          </td>
        </tr>
    <% end %>
    <tr><td><strong>DOI minted at</strong></td><td><%= @record.doi_created_at %></td></tr>
    <tr><td><strong>DOI minted by</strong></td><td><%= @record.doi_created_by %></td></tr>
    <tr><td><strong>URL</strong></td><td><%= @record.url %></td></tr>
    <tr><td><strong>URL updated at</strong></td><td><%= @record.url_updated_at %></td></tr>
    <tr><td><strong>URL updated by</strong></td><td><%= @record.url_updated_by %></td></tr>
    <tr><td><strong>Metadata updated at</strong></td><td><%= @record.metadata_updated_at %></td></tr>
    <tr><td><strong>Metadata updated by</strong></td><td><%= @record.metadata_updated_by %></td></tr>
  </table>

  <br/>
  <br/>
  <%= link_to 'Search', :dois_search, :class => 'pure-button' %>

</div>

<% flash.clear %>